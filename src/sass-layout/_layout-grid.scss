// LAYOUT GRID INIT

@mixin grid-init() {

  // merge defaults
  $base: map-merge((
    margin-x: 1rem,
  ), if(variable-exists('base'), $base, ()));

  // get values
  $margin-x: map-get($base, 'margin-x');

  // get classes
  $grid: map-get($layout-classes, 'grid');
  $cell: map-get($layout-classes, 'cell');

  // grid
  .#{$grid}, [class*="#{$grid}--"] {
    &:before { display: none; } // in case of salvattore
    width: calc(100% + #{$margin-x}); // necessary?
    // position: relative; // avoidable?
    margin-left: $margin-x / -2;
    margin-right: $margin-x / -2;
    @if $grid-is-float {
      @include clearfix();
    } @else {
      font-size: 0rem;
      & > * { font-size: 1rem; }
    }
  }

  // cell
  .#{$cell}, [class*="#{$cell}--"] {
    width: 100%;
    padding-left: $margin-x / 2;
    padding-right: $margin-x / 2;
    @if $grid-is-float {
      display: block;
      float: $grid-alignment;
      min-height: 1px; // http://css-tricks.com/make-sure-columns-dont-collapse-horizontally/
    } @else {
      display: inline-block;
      text-align: $grid-alignment;
      vertical-align: top;
    }
  }

  @if variable-exists('media') {

    @each $alias, $medium in $media {

      @if map-has-key(medium-orig($alias), 'margin-x') {

        $margin-x: map-get($medium, 'margin-x');

        @include medium($alias) {

          // grid
          .#{$grid} {
            width: calc(100% + #{$margin-x}); // necessary?
            margin-left: $margin-x / -2;
            margin-right: $margin-x / -2;
          }

          // cell
          .#{$cell} {
            padding-left: $margin-x / 2;
            padding-right: $margin-x / 2;
          }
        }
      }
    }
  }
}
