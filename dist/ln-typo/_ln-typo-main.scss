// TYPO main mixin, stable

@mixin typo($size: 0, $alias: null, $height: auto){

  // get classes and values
  $line: map-get($trim-classes, 'line');
  $content: map-get($trim-classes, 'content');
  $char-height: get($fonts, $alias, 'char-height') or 1;

  // normalize font-size; NB change the size() function
  $size: if(unitless($size), size($size), if(unit($size) == 'px', rem($size), $size));

  // normalize line-height
  @if $height == 'auto' {
    $sub-lines: $typo-sub-lines or ceil($size);
    $rel-height: medium-value('line-height') / unit-strip($size);
    $height: $rel-height * ceil($typo-min-height / $rel-height * $sub-lines) / $sub-lines;
  }

  font-size: $size;
  line-height: $height;
  margin-top: 0;
  margin-bottom: 0;

  // get trim value for effectively 0 margin
  $trim-margin: trim-margin(0rem, $height, $char-height);

  &.#{$line} { line-height: 1; }
  &.trim--top { margin-top: $trim-margin; }
  &.trim--bottom { margin-bottom: $trim-margin; }
  &.trim--both { margin-top: $trim-margin; margin-bottom: $trim-margin; }

  .trim--#{$content} & {
    margin-bottom: $trim-margin;
    margin-top: margin();
    // QUESTION: does it make more sense to include this whole mixin
    // inside media((for: margin-y, font-size, line-height)) ?
    // @include media((for: 'margin-y')) { margin-top: margin(); }
    &:first-child { margin-top: $trim-margin; }
  }

  // allow content to be added and refer to current size and height
  $typo-curr-font-size: $size !global;
  $typo-curr-line-height: $height !global;
  $typo-curr-char-height: $char-height !global;
  @content;
  $typo-curr-font-size: null !global;
  $typo-curr-line-height: null !global;
  $typo-curr-char-height: null !global;
}
