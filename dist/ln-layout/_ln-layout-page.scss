
// LAYOUT PAGE INIT

@mixin setup-page() {

  // merge defaults
  $base: map-merge((
    margin-x: 1rem,
    margin-y: 1.5rem,
    page-top: 1.5rem,
    page-right: 1rem,
    page-bottom: 1.5rem,
    page-left: 1rem
  ), if(variable-exists('base'), $base, ()));

  // get values
  $margin-x: map-get($base, 'margin-x');
  $margin-y: map-get($base, 'margin-y');
  $page-top: map-get($base, 'page-top');
  $page-right: map-get($base, 'page-right');
  $page-bottom: map-get($base, 'page-bottom');
  $page-left: map-get($base, 'page-left');

  // get classes
  $page: map-get($layout-classes, 'page');
  $wrap: map-get($layout-classes, 'wrap');

  // do clearfix on all
  .cf,
  .#{$wrap},
  [class*="#{$wrap}--"],
  [class*="#{$page}--"] {
    @include clearfix();
  }

  // base page
  .#{$page}--top { padding-top: $page-top; }
  .#{$page}--right { padding-right: $page-right; }
  .#{$page}--bottom { padding-bottom: $page-bottom; }
  .#{$page}--left { padding-left: $page-left; }
  .#{$page}--x { padding-left: $page-left; padding-right: $page-right; }
  .#{$page}--y { padding-top: $page-top; padding-bottom: $page-bottom; }
  .#{$page}--h { @extend .#{$page}--x; }
  .#{$page}--v { @extend .#{$page}--y; }

  // base wrap
  .#{$wrap}, [class*="#{$wrap}--"] {
    @if $layout-alignment != left { margin-left: auto; }
    @if $layout-alignment != right { margin-right: auto; }
  }
  .#{$wrap}--left { margin-left: 0; }
  .#{$wrap}--right { margin-right: 0; }

  @if variable-exists('media') {

    @each $alias, $medium in $media {
      $margin-x: map-get($medium, 'margin-x');
      $margin-y: map-get($medium, 'margin-y');
      $page-top: map-get($medium, 'page-top');
      $page-right: map-get($medium, 'page-right');
      $page-bottom: map-get($medium, 'page-bottom');
      $page-left: map-get($medium, 'page-left');

      @include medium($alias) {

        $orig: medium-orig();

        // page
        .#{$page}--top { @if map-has-key($orig, 'page-top') { padding-top: $page-top; } }
        .#{$page}--right { @if map-has-key($orig, 'page-right') { padding-right: $page-right; } }
        .#{$page}--bottom { @if map-has-key($orig, 'page-bottom') { padding-bottom: $page-bottom; } }
        .#{$page}--left { @if map-has-key($orig, 'page-left') { padding-left: $page-left; } }
        .#{$page}--x {
          @if map-has-key($orig, 'page-left') { padding-left: $page-left; }
          @if map-has-key($orig, 'page-right') { padding-right: $page-right; }
        }
        .#{$page}--y {
          @if map-has-key($orig, 'page-top') { padding-top: $page-top; }
          @if map-has-key($orig, 'page-bottom') { padding-bottom: $page-bottom; }
        }

        // wrap
        $media-keys: map-keys($media);
        // $wrap-from-string: map-get($layout-wrap-strings, 'from');
        $wrap-from-keys: slice($media-keys, 1, index($media-keys, $alias));
        // $wrap-to-string: map-get($layout-wrap-strings, 'to');
        $wrap-to-keys: slice($media-keys, index($media-keys, $alias), length($media-keys));
        $wrap-from: ();
        $wrap-to: ();
        $wrap-fromTo: ();
        // $wrap-fromTo-string: map-get($layout-wrap-strings, 'fromTo');

        // wrap--fromTo
        @each $fromKey in $wrap-from-keys {
          @each $toKey in $wrap-to-keys {
            @if $fromKey != $toKey {
              $wrap-fromTo: append($wrap-fromTo, unquote('\a.#{$wrap}--#{$fromKey}-to-#{$toKey}'), 'comma');
            }
          }
        }

        // wrap--from
        @each $fromKey in $wrap-from-keys {
          $wrap-from: append($wrap-from, unquote('\a.#{$wrap}--#{$fromKey}-to'), 'comma');
        }

        // wrap--to
        @each $toKey in $wrap-to-keys {
          $wrap-to: append($wrap-to, unquote('\a.#{$wrap}-to-#{$toKey}'), 'comma');
        }

        .#{$wrap}--each,
        .#{$wrap}--#{$alias},
        #{$wrap-fromTo}, #{$wrap-from}, #{$wrap-to} {
          max-width: medium-value('content-width');
        }
      }
    }
  }
}

// MIXINS

// PAGE

// page
@mixin page($suffix){
  @extend .page--#{$suffix};
}

// wrap
@mixin wrap($width){
  @if type-of($width) == 'string' {
    @extend .wrap--#{$width};
  } @else {
    @extend .wrap; max-width: $width;
  }
}
